<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reserva de Servicios</title>
    <link href="../dist/output.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/es.js"></script>
    <script src="../js/menu.js" defer></script>
    <script src="../js/servicios.js" defer></script>
</head>

<body class="bg-vet-cream min-h-screen">
    <nav class="nav-light static top-0 left-0 right-0 z-50 px-6 py-4">
        <div class="max-w-full mx-auto flex items-center justify-between">
            <!-- Logo compacto -->
            <div class="flex items-center">
                <img src="../assets/Logo 4.png" alt="El Buen Amigo Logo"
                    class="w-24 h-24 object-contain transition-all duration-300">
                <span
                    class="text-white text-xl font-bold drop-shadow-lg transition-all duration-300 mb-3  max-lg:hidden">Veterinaria
                    El Buen Amigo</span>
            </div>

            <!-- Menú central -->
            <div class="hidden md:flex items-center absolute left-1/2 transform -translate-x-1/2">
                <div class="bg-vet-dark/90 backdrop-blur-md rounded-2xl px-6 py-2 shadow-xl border border-white/20">
                    <div class="flex items-center space-x-8">
                        <a href="../home.html"
                            class="text-white hover:text-black transition-colors duration-300 text-sm font-medium">Inicio</a>
                        <a href="..#servicios"
                            class="text-white hover:text-black transition-colors duration-300 text-sm font-medium">Servicios</a>
                        <a href="#productos"
                            class="text-white hover:text-black transition-colors duration-300 text-sm font-medium">Productos</a>
                        <a href="../index.html#valoranos"
                            class="text-white hover:text-black transition-colors duration-300 text-sm font-medium">Valoranos</a>
                        <a href="../index.html#app"
                            class="text-white hover:text-black transition-colors duration-300 text-sm font-medium">App</a>
                    </div>
                </div>
            </div>

            <!-- Botón de menú hamburguesa para móvil -->
            <div class="relative md:hidden">
                <button id="menu-toggle" class="text-white p-2">
                    <img src="../assets/burguer.svg" alt="Menu" class="w-6 h-6">
                </button>

                <!-- Menú móvil desplegable -->
                <div id="mobile-menu"
                    class="hidden absolute right-0 top-full mt-2 w-48 bg-vet-cream rounded-2xl shadow-lg py-2 z-50">
                    <a href="./../home.html"
                        class="block px-4 py-2 text-black hover:text-vet-orange/90 transition-colors duration-300 font-medium">Inicio</a>
                    <a href="./pages/servicios.html"
                        class="block px-4 py-2 text-black hover:text-vet-orange/90 transition-colors duration-300 font-medium">Servicios</a>
                    <a href="./pages/productos.html"
                        class="block px-4 py-2 text-black hover:text-vet-orange/90 transition-colors duration-300 font-medium">Productos</a>
                    <a href="#valoranos"
                        class="block px-4 py-2 text-black hover:text-vet-orange/90 transition-colors duration-300 font-medium">Contacto</a>
                    <hr class="my-2">
                    <div class="flex items-center justify-evenly space-x-4">
                        <a href="./pages/login.html"
                            class="text-white hover:text-vet-light transition-colors duration-300 text-sm font-medium drop-shadow-lg">
                            Login
                        </a>
                        <a href="./pages/registro.html"
                            class="bg-vet-orange text-white px-4 py-2 rounded-xl text-sm font-medium hover:bg-vet-orange/90 transition-colors duration-300 shadow-lg">
                            Registro
                        </a>
                    </div>
                </div>
            </div>

            <div class="flex items-center space-x-4 max-md:hidden">
                <a href="../pages/login.html"
                    class="text-white hover:text-vet-light transition-colors duration-300 text-sm font-medium drop-shadow-lg">
                    Login
                </a>
                <a href="../pages/registro.html"
                    class="bg-vet-orange text-white px-4 py-2 rounded-xl text-sm font-medium hover:bg-vet-orange/90 transition-colors duration-300 shadow-lg">
                    Registro
                </a>
            </div>
        </div>
    </nav>
    <main class="px-4 py-8 max-w-7xl mx-auto">
        <h1 class="text-2xl md:text-4xl font-bold text-center text-vet-dark mb-8">Reserva tu Servicio</h1>

        <!-- Contenedor principal con tres secciones -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <!-- Sección 1: Selección de Servicio -->
            <div class="bg-vet-blue p-6 rounded-2xl shadow-lg">
                <h2 class="text-xl font-semibold mb-4 text-white">1. Selecciona el Servicio</h2>
                <form id="servicio-form" class="space-y-4">
                    <div>
                        <select id="servicio" name="servicio" required
                            class="mt-1 block w-full rounded-md shadow-sm p-2 focus:ring-vet-orange focus:border-vet-orange border-vet-orange">
                            <option value="">Selecciona un servicio</option>
                            <option value="consulta">Consulta General</option>
                            <option value="vacuna">Vacunación</option>
                            <option value="cirugia">Cirugía</option>
                            <option value="baño">Baño y Aseo</option>
                        </select>
                    </div>

                    <!-- Campos específicos para vacunas -->
                    <div id="vacuna-fields" class="hidden">
                        <select id="tipo-vacuna" name="tipo-vacuna"
                            class="mt-1 block w-full rounded-md shadow-sm p-2 focus:ring-vet-orange focus:border-vet-orange border-vet-orange">
                            <option value="">Selecciona tipo de vacuna</option>
                            <option value="rabia">Rabia</option>
                            <option value="parvovirus">Parvovirus</option>
                            <option value="moquillo">Moquillo</option>
                        </select>
                    </div>
                </form>
            </div>

            <!-- Sección 2: Selección de Veterinario -->
            <div class="bg-vet-blue p-6 rounded-2xl shadow-lg">
                <h2 class="text-xl font-semibold mb-4 text-white">2. Selecciona el Veterinario</h2>
                <div id="veterinarios" class="space-y-3">
                    <!-- Los veterinarios se cargarán dinámicamente según el servicio -->
                </div>
            </div>

            <!-- Sección 3: Calendario -->
            <div class="bg-vet-blue p-6 rounded-2xl shadow-lg">
                <h2 class="text-xl font-semibold mb-4 text-white">3. Selecciona la Fecha</h2>
                <div class="w-full">
                    <div id="calendario" class="mx-auto"></div>
                </div>

                <!-- Horarios disponibles -->
                <div id="horarios" class="mt-4 hidden">
                    <h3 class="text-lg font-medium mb-2">Horarios Disponibles</h3>
                    <div class="relative">
                        <button id="horario-dropdown" type="button"
                            class="w-full bg-white rounded-lg px-4 py-2.5 text-left flex justify-between items-center">
                            <span id="horario-seleccionado">Seleccionar horario</span>
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
                                    clip-rule="evenodd" />
                            </svg>
                        </button>
                        <div id="horario-opciones"
                            class="hidden absolute z-10 w-full mt-1 bg-white rounded-lg shadow-lg max-h-60 overflow-auto">
                            <div class="py-1" role="menu">
                                <!-- Los horarios se cargarán dinámicamente aquí -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Botón de confirmación -->
        <div class="mt-8 text-center">
            <button id="confirmar-reserva" disabled
                class="bg-vet-orange text-white px-8 py-3 rounded-full font-bold hover:bg-vet-orange/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                Confirmar Reserva
            </button>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const servicioSelect = document.getElementById('servicio');
            const vacunaFields = document.getElementById('vacuna-fields');
            const veterinariosContainer = document.getElementById('veterinarios');
            const horariosContainer = document.getElementById('horarios');
            const confirmarBtn = document.getElementById('confirmar-reserva');

            // Ejemplo de datos de veterinarios (esto debería venir de tu backend)
            const veterinariosPorServicio = {
                consulta: [
                    { id: 1, nombre: 'Dr. Juan Pérez', especialidad: 'Medicina General' },
                    { id: 2, nombre: 'Dra. María García', especialidad: 'Medicina General' }
                ],
                vacuna: [
                    { id: 3, nombre: 'Dr. Carlos López', especialidad: 'Inmunología' },
                    { id: 4, nombre: 'Dra. Ana Martínez', especialidad: 'Inmunología' }
                ],
                // ... más servicios
            };

            // Cuando se selecciona un servicio
            servicioSelect.addEventListener('change', function () {
                // Mostrar/ocultar campos de vacuna
                vacunaFields.style.display = this.value === 'vacuna' ? 'block' : 'none';

                // Cargar veterinarios correspondientes
                cargarVeterinarios(this.value);

                // Resetear selección de fecha
                horariosContainer.classList.add('hidden');
                confirmarBtn.disabled = true;
            });

            function cargarVeterinarios(servicio) {
                veterinariosContainer.innerHTML = '';
                const veterinarios = veterinariosPorServicio[servicio] || [];

                veterinarios.forEach(vet => {
                    const button = document.createElement('button');
                    button.className = 'w-full p-3 text-left rounded-lg bg-gray-100 hover:bg-vet-orange hover:text-white transition-colors';
                    button.innerHTML = `
                        <div class="font-medium">${vet.nombre}</div>
                        <div class="text-sm text-gray-600">${vet.especialidad}</div>
                    `;

                    button.addEventListener('click', () => seleccionarVeterinario(vet, button));
                    veterinariosContainer.appendChild(button);
                });
            }

            function seleccionarVeterinario(veterinario, buttonElement) {
                // Resetear todos los botones
                document.querySelectorAll('#veterinarios button').forEach(btn => {
                    btn.classList.remove('bg-vet-orange', 'text-white');
                });

                // Marcar el seleccionado
                buttonElement.classList.add('bg-vet-orange', 'text-white');

                // Mostrar horarios disponibles
                horariosContainer.classList.remove('hidden');

                // Aquí deberías cargar los horarios disponibles del veterinario
                cargarHorarios(veterinario);
            }

            // Inicializar calendario
            flatpickr("#calendario", {
                locale: "es",
                minDate: "today",
                dateFormat: "Y-m-d",
                inline: true,
                onChange: function (selectedDates, dateStr) {
                    // Actualizar horarios disponibles según la fecha
                    const veterinarioSeleccionado = document.querySelector('#veterinarios button.bg-vet-orange');
                    if (veterinarioSeleccionado) {
                        cargarHorarios(veterinarioSeleccionado.dataset.id, dateStr);
                    }
                }
            });
        });
    </script>
</body>

</html>